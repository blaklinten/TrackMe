#!/bin/bash

chooseClient()
{
	export SCRIPT=$1

	AVAILABLE_CLIENTS="$(for CLIENT in $(ls $CLIENTS); do parseUnderscores $CLIENT; done)"
	ANS="$(showAndRead "Choose an existing client, create a (n)ew or (q)uit:" "$AVAILABLE_CLIENTS")"
	CHOICE="$(parseSpaces "$ANS")"

	case "$CHOICE" in
    	"q")
        	showAndRead "Exiting..."
        	pkill trackMe
        	exit
       ;;
    	"n")
        	createClient 
        	exit
       ;;
    	*)
        	pushd "$CLIENTS" > /dev/zero
        	for CLIENT in *; do
            	if [[ "$CLIENT" == "$CHOICE" ]]; then
                	echo "$CLIENT"
                	popd > /dev/zero
                	exit
            	fi
        	done
            	showAndRead "Client \"$CHOICE\" does not exist, try again or create it (n)."
            	chooseClient "$SCRIPT"
       ;;
	esac
}

chooseProject()
{
	export SCRIPT="$1"

	CHOICE="$(parseSpaces $(showAndRead "Choose an existing project, create a (n)ew or (q)uit" "$(for PROJECT in $(ls $PROJECTS); do parseUnderscores $PROJECT; done)"))"

	case $CHOICE in
    	"q")
        	exit
        	;;
    	"n")
        	createProject 
        	;;
    	*)
        	pushd "$PROJECTS" > /dev/zero
        	for PROJECT in *; do
            	if [[ "$PROJECT" == "$CHOICE" ]]; then
                	"$SCRIPT" "$CHOICE"
                	popd > /dev/zero
                	return
            	fi
        	done
        	showAndRead "Project \"$(parseUnderscores "$CHOICE")\" does not exist, try again or create it (n)."
            	chooseProject "$SCRIPT"
            	exit
        	;;
	esac
}
