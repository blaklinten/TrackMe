#!/bin/bash

#########################################################
# This is a script that helps me keep track of my time. #
#########################################################

source configure
source $WD/.choose
source $WD/.create
source $WD/.gitFunctions
source $WD/.parse
source $WD/.startStop
source $WD/.summarize
source $WD/.utils

if [[ ! -f "$ACTIVE" ]]; then
    export CLIENT=$(chooseClient)
else
    export CLIENT=$(head -n 1 "$ACTIVE")
    dmenu -p "Client $(parseUnderscores "$CLIENT") is running a timer."
fi
export PROJECTS="$CLIENTS/$CLIENT"

while true; do
    CHOICE=$(cat $WD/.choices | dmenu -i -p "What do you want to do?")
    case "$CHOICE" in
        "start")
            if [[ -f "$ACTIVE" ]]; then
                dmenu -p "A timer is already running..."
            else
                chooseProject "startActivity"
            fi
            ;;
        "summarize")
            chooseProject "summarize"
            ;;
        "stop")
            stopActivity
            ;;
        "status")
            showStatus
            ;;
        "help")
            xmessage -c -file $WD/.man
            ;;
        "switch")
            trackMe
            exit
            ;;
        "quit")
            exit
            ;;
    esac
done
