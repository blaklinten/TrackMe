#!/bin/bash

# Summarizing entries for a given activity

# Set current activity
PROJECT=$1

# Initial values of hours,
# minutes and seconds
HOURS=0
MINUTES=0
SECONDS=0

for ACTIVITY in $(ls $PROJECT); do
    for line in $(sed -n '0~3p' $PROJECT/$ACTIVITY); do
        if [[ ! $line == "Duration:" ]]; then
            let "HOURS = $HOURS + $(echo $line | sed -n -e 's/^\(.*\):\(.*\):\(.*\)/\1/p')"
            let "MINUTES = $MINUTES + $(echo $line | sed -n -e 's/^\(.*\):\(.*\):\(.*\)/\2/p')"
            let "SECONDS = $SECONDS + $(echo $line | sed -n -e 's/^\(.*\):\(.*\):\(.*\)/\3/p')"
        fi
    done
done

# Debug
echo $HOURS:$MINUTES:$SECONDS
let "HOURS = $HOURS + ($MINUTES + $SECONDS / 60) / 60"
let "MINUTES = ($MINUTES + $SECONDS / 60) % 60"
let "SECONDS = $SECONDS % 60"

echo "Total time = $HOURS:$MINUTES:$SECONDS" | dmenu
