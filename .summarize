#!/bin/bash

# Summarize time for a given project or activity

# Set project too work with
PROJECT=$1

# Instruct user what to do 
# print existing activities in chosen project
# and wait for user input
choice=$($WD/.parseSpaces $(echo -e "Choose one activity \nall\nor\nquit\n$(for project in $(ls $PROJECTS/$PROJECT); do $WD/.parseUnderscores $project; done)" | dmenu -i))

case $choice in 
    "quit")
        exit
        ;;
    "all")
        $WD/.addProject $PROJECTS/$PROJECT
        exit
        ;;
    *)
        # Check if given activity exist and if not
        # ask again
        pushd $PROJECTS/$PROJECT > /dev/zero
        for activity in *; do
            if [[ "$choice" == "$activity" ]]; then
                # If activity exist then sum all
                # entries
                $WD/.addEntries $PROJECTS/$PROJECT/$choice
                popd > /dev/zero
                exit
            fi
        done
        echo "Activity \"$choice\" does not exist, try again or exit (q)." | dmenu
        $WD/.summarize $PROJECT
        ;;
esac
